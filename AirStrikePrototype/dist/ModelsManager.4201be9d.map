{"version":3,"sources":["ModelsManager.js"],"names":["getModelBufferCollection","gl","ExampleModel","getModelFromOBJ","x1","getModelBuffer","Model","VertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","vertexPos","STATIC_DRAW","TextureBuffer","textureUV","NormalBuffer","normalVec","NumVertices","numVertices","path","readTextFile","file","string","rawFile","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","send","vertex","gl_obj","handleobj","uv","normal","GetTextureCollection","textureEarth","initTexture","textureSkyBox","Earth","SkyBox","src","texture","createTexture","image","Image","onload","handleLoadedTexture","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","texImage2D","RGB","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","activeTexture","TEXTURE0","regex","vertex_pattern","normal_pattern","uv_pattern","face_vertex_uv_normal","prototype","vertexArr","normalArr","uvArr","addFace","data","addIndex","addUv","addNormal","a","b","c","d","push","str","obj","result","exec"],"mappings":"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","file":"ModelsManager.4201be9d.map","sourceRoot":"..","sourcesContent":["// Models Manager\n//////////// - 模 型 管 理 器 - //////////////\n//////////// - 模 型 管 理 器 - //////////////\n//////////// - 模 型 管 理 器 - //////////////\n/***\n * 模型管理器\n * 本管理器负责Parse OBJ文件/读取JSON文件（取决于是否提前将OBJ转化为JSON）\n * 本管理器还负责整理纹理，并提供创建纹理的函数\n * 本管理器输出的对象为模型Buffer的全体的对象（可以理解成一个指针吧）+ 纹理全体的对象，这个对象可以在CreateGenericObjects中绘制泛型模型的过程中，\n *      通过直接访问对象的字段名来访问模型的Buffer和Texture对象，并将其赋到模型的物体上。\n */\n\n/////////////////////////////////////////////////////////////////////////////////////\n/////////////////////////////// 读取模型 返回Buffers ///////////////////////////////////\n/////////////////////////////////////////////////////////////////////////////////////\n\n/***\n * 模型集\n * 返回一个对象，通过属性名来访问 / 通过数组来访问\n * 整合convert_obj_to_json.js\n * @param gl\n * @returns {{ExampleModel: {VertexBuffer: (AudioBuffer|WebGLBuffer), TextureBuffer: (AudioBuffer|WebGLBuffer), NormalBuffer: (AudioBuffer|WebGLBuffer), NumVertices: number}}}\n */\nfunction getModelBufferCollection(gl)\n{\n    let ExampleModel = getModelFromOBJ(\"./ModelObjects/Example.obj\");\n    // let CarModel = getModelFromOBJ(\"./ModelObjects/CarModel.obj\");\n    // let Whatever = getModelFromOBJ(\"./ModelObjects/whatever.obj\");\n    let x1 = getModelBuffer(gl, ExampleModel);\n    return{\n        ExampleModel: x1\n        // , Whatever: getModelBuffer(gl, Whatever)\n    }\n}\n\n/***\n * 根据模型数组对象建立Buffer\n * @param gl\n * @param Model     Model对象是由`function getModelFromOBJ(path)`生成的\n * @returns {{VertexBuffer: AudioBuffer | WebGLBuffer, TextureBuffer: AudioBuffer | WebGLBuffer, NormalBuffer: AudioBuffer | WebGLBuffer, NumVertices: number}}\n * 返回的是Buffer对象\n */\nfunction getModelBuffer(gl, Model)\n{\n    const VertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, VertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(Model.vertexPos), gl.STATIC_DRAW);\n\n    const TextureBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, TextureBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(Model.textureUV), gl.STATIC_DRAW);\n\n    const NormalBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, NormalBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(Model.normalVec), gl.STATIC_DRAW);\n\n    return {\n        VertexBuffer:   VertexBuffer,\n        TextureBuffer:  TextureBuffer,\n        NormalBuffer:   NormalBuffer,\n        NumVertices:    Model.numVertices\n    }\n}\n\n// 此函数是生成数组并提取 而非生成buffer\nfunction getModelFromOBJ(path)\n{\n    // let fs = require('fs');\n    // const vertex = fs.readFileSync(path, 'utf8');\n    // 我有一个不需要另外npm一个组件的方法 直接用AJAX 因为我不太会（笑哭）如果解决了的话那也可以不要\n    function readTextFile(file)\n    {\n        let string = \"\";\n        let rawFile = new XMLHttpRequest();\n        rawFile.open(\"GET\", file, false);\n        rawFile.onreadystatechange = function()\n        {\n            if(rawFile.readyState === 4)\n            {\n                if(rawFile.status === 200 || rawFile.status == 0)\n                {\n                    string = rawFile.responseText;\n                }\n            }\n        };\n        rawFile.send(null);\n        return string;\n    }\n    let vertex = readTextFile(path);\n\n    const Model = new gl_obj();\n    handleobj(vertex, Model);   // Parse的驱动程序见后侧\n\n    return {\n        vertexPos:   Model.vertex,\n        textureUV:   Model.uv,\n        normalVec:   Model.normal,\n        numVertices: Model.numVertices\n    }\n}\n\n/////////////////////////////////////////////////////////////////////////////////////\n//////////////////// 纹理管理器：读取纹理贴图 生成Texture对象 ////////////////////////////\n/////////////////////////////////////////////////////////////////////////////////////\nfunction GetTextureCollection(gl) {\n    // 手动添加需要用到的纹理贴图\n    let textureEarth = initTexture(gl, \"./Textures/Earth.jpg\");\n    let textureSkyBox = initTexture(gl, \"./Textures/SkyBox.jpg\");\n\n    return {\n        Earth: textureEarth,\n        SkyBox: textureSkyBox\n    }\n}\n\n// 初始化图片为texture对象\n// 返会texture\nfunction initTexture(gl, src){\n    let texture = gl.createTexture();\n    texture.image = new Image();\n    texture.image.onload = function () {\n        handleLoadedTexture(texture);\n    };\n\n    texture.image.src = src;\n    return texture;\n\n    function handleLoadedTexture(texture) {\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, texture.image);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\n        gl.activeTexture(gl.TEXTURE0);\n    }\n}\n\n\n\n\n/////////////////////////////////////////////////////////////////////////////////////\n//////////////////////////////// OBJ Parser 驱动程序 //////////////////////////////////\n/////////////////////////////////////////////////////////////////////////////////////\n\nvar regex = { // 这里正则只去匹配了我们obj文件中用到数据\n    vertex_pattern: /v\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/g, // 顶点\n    normal_pattern: /vn\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/g, // 法线\n    uv_pattern: /vt\\s+([\\d|\\.|\\+|\\-|e|E]+)\\s+([\\d|\\.|\\+|\\-|e|E]+)/g, // 纹理坐标\n    face_vertex_uv_normal: /f\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+)(?:\\s+(-?\\d+)\\/(-?\\d+)\\/(-?\\d+))?/g, // 面信息\n};\n\nfunction gl_obj() {};  //这是个类，类的规则写好了，之后 new一个新的就可用了\ngl_obj.prototype.vertexArr=[]\ngl_obj.prototype.normalArr=[]\ngl_obj.prototype.uvArr=[]\n\ngl_obj.prototype.normal=[]\ngl_obj.prototype.vertex=[]\ngl_obj.prototype.uv=[]\n\ngl_obj.prototype.addFace=function(data){\n    this.addIndex(+data[1], +data[4], +data[7], +data[10]);\n    this.addUv(+data[2], +data[5], +data[8], +data[11]);\n    this.addNormal(+data[3], +data[6], +data[9], +data[12]);\n\n}\n\n// Minor Update: 添加一个计数器，为了使得我们能够计算出有多少个Vertex，然后将其传入drawArray中\ngl_obj.prototype.numVertices = 0;\n\ngl_obj.prototype.addIndex = function(a, b, c, d) {\n    if(!d) {\n        this.vertex.push(  //有些f里，就是一个面有三个点\n            this.vertexArr[3*a], this.vertexArr[3*a+1], this.vertexArr[3*a+2],\n            this.vertexArr[3*b], this.vertexArr[3*b+1], this.vertexArr[3*b+2],\n            this.vertexArr[3*c], this.vertexArr[3*c+1], this.vertexArr[3*c+2]\n        );\n        this.numVertices += 3;\n    }\n    else {//有些有两个\n        this.vertex.push(\n            this.vertexArr[3*a], this.vertexArr[3*a+1], this.vertexArr[3*a+2],\n            this.vertexArr[3*b], this.vertexArr[3*b+1], this.vertexArr[3*b+2],\n            this.vertexArr[3*c], this.vertexArr[3*c+1], this.vertexArr[3*c+2],\n            this.vertexArr[3*a], this.vertexArr[3*a+1], this.vertexArr[3*a+2],\n            this.vertexArr[3*c], this.vertexArr[3*c+1], this.vertexArr[3*c+2],\n            this.vertexArr[3*d], this.vertexArr[3*d+1], this.vertexArr[3*d+2],\n        );\n        this.numVertices += 6;\n    }\n};\n\ngl_obj.prototype.addNormal = function(a, b, c, d) {\n    if(!d) {\n        this.normal.push(\n            this.normalArr[3*a], this.normalArr[3*a+1], this.normalArr[3*a+2],\n            this.normalArr[3*b], this.normalArr[3*b+1], this.normalArr[3*b+2],\n            this.normalArr[3*c], this.normalArr[3*c+1], this.normalArr[3*c+2]\n        );\n    } else {\n        this.normal.push(\n            this.normalArr[3*a], this.normalArr[3*a+1], this.normalArr[3*a+2],\n            this.normalArr[3*b], this.normalArr[3*b+1], this.normalArr[3*b+2],\n            this.normalArr[3*c], this.normalArr[3*c+1], this.normalArr[3*c+2],\n            this.normalArr[3*a], this.normalArr[3*a+1], this.normalArr[3*a+2],\n            this.normalArr[3*c], this.normalArr[3*c+1], this.normalArr[3*c+2],\n            this.normalArr[3*d], this.normalArr[3*d+1], this.normalArr[3*d+2],\n        );\n    }\n};\ngl_obj.prototype.addUv = function(a, b, c, d) {\n    if(!d) {\n        this.uv.push(this.uvArr[2*a], this.uvArr[2*a+1] );\n        this.uv.push(this.uvArr[2*b], this.uvArr[2*b+1] );\n        this.uv.push(this.uvArr[2*c], this.uvArr[2*c+1] );\n    } else {\n        this.uv.push(this.uvArr[2*a], this.uvArr[2*a+1] );\n        this.uv.push(this.uvArr[2*b], this.uvArr[2*b+1] );\n        this.uv.push(this.uvArr[2*c], this.uvArr[2*c+1] );\n        this.uv.push(this.uvArr[2*a], this.uvArr[2*a+1] );\n        this.uv.push(this.uvArr[2*c], this.uvArr[2*c+1] );\n        this.uv.push(this.uvArr[2*d], this.uvArr[2*d+1] );\n    }\n};\n\nfunction handleobj(str, obj) {\n    var result;\n    obj.vertexArr.push(0,0,0);//regex.vertex_pattern.exec(str)这种就是正则匹配，你们可以在debug下跟跟，看是怎么工作的\n    obj.uvArr.push(0,0);\n    obj.normalArr.push(0,0,0); //这里非常tricky，f中的点是从1开始算的，而数组 【0】是起点，我塞入一个新点，之后的就一样了，这里不塞0，0，0，塞入x,x,x都行\n    while((result = regex.vertex_pattern.exec(str)) !== null) {\n        obj.vertexArr.push(+result[1], +result[2], +result[3]); // 加入到3D对象顶点数组\n    }\n    while((result = regex.normal_pattern.exec(str)) !== null) { //加入每个顶点的发向量\n        obj.normalArr.push(+result[1], +result[2], +result[3]);\n    }\n    while((result = regex.uv_pattern.exec(str)) !== null) {//加入纹理信息\n        obj.uvArr.push(+result[1], +result[2]);\n    }\n    while((result = regex.face_vertex_uv_normal.exec(str)) !== null) {\n        obj.addFace(result);  // ！！！！！！！！！！以上数据均无顺序，我在这个addface中，\n                              //利用 f x/x/x x/x/x x/x/x x/x/x 把每一个顶点按塞到新的vertex，normal，uv中，这些信息可以直接用，不用index什么的再排序\n    }\n}"]}